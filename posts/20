---
layout: post
title:  "GAN"
date:   2024-07-28 21:04
categories: mystudy AI GAN
tags: GAN
---


고등학교 때 공부했던 GAN 내용 총정리
단순 기록용
정리해 뒀던 내용을 단순히 복사 붙여 넣기 한 것이라 정리되지 않았습니다


### 시작!

# 컴퓨터 비전
컴퓨터 비전은 기계에 눈을 달아주는 것이라고 생각합니다. 컴퓨터가 이미지와 비디오 데이터에서 정보를 추출하고 해석하여 특정 작업을 수행하도록 해줍니다. 


# GAN(Generative Adversarial Networks)
적대적 생성 신경망
실제에 가까운 이미지나 사람이 쓴 것과 같은 글 등 여러 가짜 데이터를 생성하는 모델





# 이미지 데이터에 대한 확률 분포
이미지 데이터는 다차원 특징 공간의 한 점으로 표현됩니다. 사람의 얼굴에는 통계적인 평균치가 존재할 수 있습니다. 이미지에서의 다양한 특징들이 각각의 확률 변수가 되는 분포를 의미합니다. 
일차원 데이터가 아닌 이미지 또한 벡터나 행렬과 같은 데이터 형태로 컴퓨터가 가지고 있으므로 다양한 확률 분포로 표현할 수 있습니다.

# GAN 수렴 과정
Gan은 생성 모델은 점점 더 실제와 같은 데이터를 생성하고 판별 모델은 실제와 가짜 데이터를 잘 구별할 수 있게 됩니다. 최종적으로 생성 모델이 실제 데이터와 비슷한 것을 생성하는 모델이 되는 것을 목표로 합니다.
이에 판별 모델의 분포는 처음에는 잘 판별하다가 학습이 진행될수록 생성 모델이 실제 분포에 맞게 되면서 구분을 못해 1/2로 수렴하는 형태가 되는 것입니다. 

# GAN에서의 기댓값 계산
단순히 모든 데이터를 하나씩 확인하여 식에 대입한 뒤에 평균을 계산하면 된다. 기댓값 개산은 GAN훈련 과정에서 중요한 역할은 한다. 생성기와 판별기가 각각 자신의 목표를 달성하기 위해 최적화하려고 하는 목표 함수를 정의하는 데 도움된다. 

---

GAN에 사용된 수학적 개념으로는 이미지 데이터에 대한 확률 분포와 GAN의 수렴 과정, GAN에서의 기댓값 개산이 있습니다. 
일차원 데이터가 아닌 이미지 또한 벡터나 행렬과 같은 데이터 형태로 컴퓨터가 가지고있으므로 다양한 확률 분포로 표현할 수 있습니다.

이미지는 많은 픽셀로 구성되어 있고 하나의 픽셀은 rgb의 세개의 채널을 가지고 있으므로 고차원상의 한 점으로 표현될 수 있다는 것과 고차원 공간상의 분포를 학습하는 방식으로 이미지를 학습할 수 있음을 알 수 있었습니다.

각 픽셀이 랜덤 변수로 취급되고 픽셀의 수가 고차원 분포의 차원 수와 일치하기 때문에 이미지는 고차원 공간상의 분포로 간주될 수 있습니다. 

# Latent space
데이터의 압축된 표현으로 비슷한 데이터 포인트들이 공간에서 서로 가까이 위치하게 됩니다. 이는 데이터의 특징을 학습하고 데이터를 분석하기 위한 더 간단한 표현을 찾는데 사용됩니다. 
잠재 공간을 조작하여 원하는 특성을 이미지에 반영할 수 있습니다. Latent space를 실시간으로 조작하여 이미지를 생성했습니다.
Gan에서 사용되는 latent space는 모델이 학습한 이미지의 특성을 나타내는 벡터 공간입니다. 초기에는 무작위로 선택된 잠재 벡터를 생성자에 입력하여 무작위 이미지를 생성합니다. 이후 잠재 공간에서 특정 방향으로 이동하며 이미지의 특성이 변화합니다. 
특정 잠재 벡터에 노이즈를 추가하거나 제거함으로써 조작합니다. 이를 통해 잠재 공간을 변형합니다. 이미지의 일부분이나 특정 특성에 노이즈를 더하거나 제거하여 이미지의 세부적인 특성을 바꿉니다.




# 이미지는 픽셀로 이루어져 있다고 할 때 색상 값 표현 방법
GAN은 RGB채널에 대해 학습하고 혼합 비율을 조절하여 색상을 창조하고 생성된 색상 값을 일반적으로 8비트로 표현합니다
이미지는 각 픽셀로 이루어져 있고 각 픽셀은 색상 값을 가지고 있습니다. 색상은 주로 빛의 삼원색인 빨강 초록 파랑으로 조합하여 표현됩니다.
각 색상 채널은 0부터 255까지의 값으로 표현됩니다. 0은 해당 색상이 아무런 밝기를 가지지 않음을 의미하고 255는 해당 색상의 최대 밝기를 나타냅니다. 이렇게 각 픽셀의 rgb값은 해당 픽셀의 색상을 결정합니다. 

## RGB채널이란
디지털 이미지를 구성하는 세가지 기본 색인 빨강, 초록, 파랑을 나타냅니다. 각 픽셀의 색상은 세가지 채널의 강도를 나타내는 세 개의 숫자로 표현됩니다. 0에서 255까지의 범위를 가진다. 이 세가지 값이 결합되어 해당 픽셀의 색상을 결정합니다. 




# styleGAN모델과 GAN모델의 각각의 특징
stylegan은 gan의 한 종류로 이미지 생성에 있어 더 높은 해상도와 자연스러운 이미지를 생성할 수 있는 이미지를 생성할 수 있습니다. 이 모델은 기존 gan의 한계 중 하나인 해상도와 이미지의 일관성을 향상시켰습니다. 이는 이미지를 다양한 스타일 요소로 조절할 수 있는 능력이 있어 이미지의 얼굴 표정, 헤어 스타일, 색감 등을 더 세밀하게 제어할 수 있습니다. 또한 생성된 이미지의 일관성과 자연스러움을 높이는데에 중점을 두고 있습니다. 

## 어떤 차이가 있는가
주요 차이점은 이미지의 해상도와 일관성 그리고 제어 가능한 스타일 요소의 다양성에 있습니다. 스타일갠은 이러한 측면에서 기존의 갠 모델보다 더 나은 결과물을 생성할 수 있는 현대적인 기술의 한 예시입니다.

# 2D GAN과 3D GAN 차이
2D GAN은 2차원 이미지를 생성하는 반면 3D GAN은 3차원 이미지를 생성합니다. 3D GAN은 3차원 데이터를 이용하여 훈련시켜 3차원 이미지를 생성하기 때문에 데이터가 적어 학습시키기 어렵다는 단점이 있습니다. 하지만 2D이미지를 통해 3D차원 모델을 생성하기도 합니다. 

## 2D에서 3D구조 데이터를 어떻게 합성하는가
2d이미지를 3차원 공간으로 변환하는 기술을 사용할 수 있습니다. 이를 통해 2차원 이미지의 깊이를 증가시켜 3차원 모델을 만들 수 있습니다. 
또한 2차원 이미지에 대한 깊이 정보를 얻기 위해 깊이 센서를 사용하여 기술적인 방법을 사용하여 깊이 정보를 합성할 수 있습니다. 


# +	GAN이 생성한 이미지에서 사람이 맨눈으로 볼 때 mode-collapse 잡아낼 수 있지 않은가? 왜 못 잡아낸다고 하는 것인가? 유사한 이미지만 계속해서 생성된다는 것을 사람이 인지한다면 mode-collapse를 잡아낸 것인데 왜 못 잡아낸다는 것인가?
사람이 유사한 이미지만 생성되는 것을 인지한다면 그것은 mode-collapse가 발생했음을 나타낸다. 하지만 이것은 사람이 mode-collapse를 잡아낸다는 것보다는 인지하는 것에 가깝다. 사람이 잡아낸다는 것과 인지한다는 것의 차이가 있다는 의미이다. 잡아낸다는 표현은 문제나 오류를 발견하고 이를 수정하거나 해결하는 과정을 의미한다. 예를 들어 프로그래밍에서 버그를 잡아낸다는 것은 버그를 발견하고 이를 수정하는 것을 의미한다. 반면에 인지한다는 표현은 문제나 오류의 존재를 알아차리는 것을 의미한다. 이는 문제를 해결하는 것이 아니라 문제가 있다는 사실을 인식하는 것이다. 따라서 mode-collapse를 잡아낸다는 것은 mode-collapse 문제를 발견하고 이를 해결하는 것을 의미한다. 이에 사람이 mode-collapse를 잡아내지 못한다고 표현하는 것이다. 이를 해결하기 위해서는 GAN의 훈련 과정을 조정하거나 다른 훈련 전력을 사용해야 한다. 이에 일반적으로 머신러닝 전문가나 연구자들이 수행한다. 또한 FID와 IS와 같은 객관적 평가 지표를 사용하여 수행할 수 있다. 이러한 평가 지표들은 생성된 이미지들이 얼마나 실제와 비슷한지 그리고 다양성이 얼마나 있는지를 측정한다.


밑에서 두 개 파일은 여기에 추가하지 않았다
나중에 추가하기


### 참고자료
https://pseudo-lab.github.io/Tutorial-Book/chapters/GAN/Ch1-Introduction.html
